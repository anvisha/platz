<div class= "event">
  <h2>
    <%= @event.name %>
    <span class="rsvp-info">
      <%= form_tag event_attend_path(@event) do |form| %>
        <% if @event.attended_by? current_user %>
          <input class="rsvp" type="checkbox" checked="checked"/> Attending
        <% else %>
          <input class="rsvp" type="checkbox"/> Attending
        <% end %>
      <% end %>

      <%= link_to 'See Attendees', event_users_path(@event) %>

      <% if @event.created_by?(current_user) %>
        <%= link_to 'Edit', edit_event_url(@event) %>
      <% end %>
    </span>
  </h2>

<img class="map" src="http://maps.googleapis.com/maps/api/staticmap?center=<%= @event.location %>&zoom=15&size=400x200&sensor=false&markers=size:small|<%= @event.location %>"/>

  
  <section>
    <%= @event.occurs_at.try(:strftime, "%B %d, %l:%M %p") %>
    &ndash;
    <%= @event.ends_at.try(:strftime, "%B %d, %l:%M %p") %>    
  </section>

  <section>
    <label>Location: </label>
    <%= @event.location %>
  </section>

  <section>
    <label> Open to: </label> 
    <%= @event.who %>
  </section>

  <section>
    <%= @event.description %>
  </section>
</div>


<script>
  $(document).on('click', 'input.rsvp', function(event) {
    var url = $(this).closest('form').attr('action');
    $.post(url, {attend: $(this).prop('checked')})
    
  });
</script>
